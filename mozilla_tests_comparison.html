<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1">
  <title>yatexml Mozilla Tests Comparison (Dynamic)</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h1 { color: #333; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th { background-color: #4CAF50; color: white; padding: 12px; text-align: left; }
    td { border: 1px solid #ddd; padding: 8px; }
    tr:nth-child(even) { background-color: #f2f2f2; }
    .test-num { width: 40px; text-align: center; font-weight: bold; }
    .latex-source { font-family: 'Courier New', monospace; font-size: 0.9em; max-width: 300px; }
    .mathml-output { text-align: center; font-size: 1.2em; }
    .error { color: red; font-weight: bold; }
    .success { color: green; }
    .comment { font-size: 0.85em; color: #666; }
    .loading { color: #666; font-style: italic; }
  </style>
</head>
<body>
  <h1>yatexml Mozilla Tests Comparison (Dynamic)</h1>
  <p>Generated from TeMML's mozilla-tests.html - 30 test cases from the TeXbook</p>
  <p><strong>Status:</strong> <span id="status" class="loading">Loading...</span></p>
  <p><em>This page dynamically executes LaTeX to MathML conversion using the compiled yatexml library.</em></p>

  <table id="test-table">
    <tr>
      <th>#</th>
      <th>LaTeX Source</th>
      <th>yatexml Output</th>
      <th>Status</th>
      <th>Comment</th>
    </tr>
    <tr data-latex="x^2y^2">
      <td class='test-num'>1</td>
      <td class='latex-source'>x^2y^2</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p128</td>
    </tr>
    <tr data-latex="_2F_3">
      <td class='test-num'>2</td>
      <td class='latex-source'>_2F_3</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p128</td>
    </tr>
    <tr data-latex="x+y^2\over k+1">
      <td class='test-num'>3</td>
      <td class='latex-source'>x+y^2\over k+1</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p139</td>
    </tr>
    <tr data-latex="x+y^{2\over k+1}">
      <td class='test-num'>4</td>
      <td class='latex-source'>x+y^{2\over k+1}</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p139</td>
    </tr>
    <tr data-latex="a\over{b/2}">
      <td class='test-num'>5</td>
      <td class='latex-source'>a\over{b/2}</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p139</td>
    </tr>
    <tr data-latex="a_0 + \cfrac{1}{a_1 + \cfrac{1}{a_2 + \cfrac{1}{a_3 + \cfrac{1}{a_4}}}}">
      <td class='test-num'>6</td>
      <td class='latex-source'>a_0 + \cfrac{1}{a_1 + \cfrac{1}{a_2 + \cfrac{1}{a_3 + \cfrac{1}{a_4}}}}</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p142</td>
    </tr>
    <tr data-latex="a_0+{1\over a_1+{1\over a_2+{1\over a_3+ {1\over a_4}}}}">
      <td class='test-num'>7</td>
      <td class='latex-source'>a_0+{1\over a_1+{1\over a_2+{1\over a_3+ {1\over a_4}}}}</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p142</td>
    </tr>
    <tr data-latex="n\choose {k/ 2}">
      <td class='test-num'>8</td>
      <td class='latex-source'>n\choose {k/ 2}</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p143</td>
    </tr>
    <tr data-latex="{p \choose 2} x^2 y^{p-2} - {1\over{1-x}} {1\over{1-x^2}}">
      <td class='test-num'>9</td>
      <td class='latex-source'>{p \choose 2} x^2 y^{p-2} - {1\over{1-x}} {1\over{1-x^2}}</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p143</td>
    </tr>
    <tr data-latex="\sum_{\scriptstyle 0 \le i \le m \atop \scriptstyle 0 &lt; j &lt; n} P(i, j)">
      <td class='test-num'>10</td>
      <td class='latex-source'>\sum_{\scriptstyle 0 \le i \le m \atop \scriptstyle 0 &lt; j &lt; n} P(i, j)</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p145</td>
    </tr>
    <tr data-latex="x^{2y}">
      <td class='test-num'>11</td>
      <td class='latex-source'>x^{2y}</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p128</td>
    </tr>
    <tr data-latex="\sum_{i=1}^p \sum_{j=1}^q \sum_{k=1}^r a_{ij}b_{jk}c_{ki}">
      <td class='test-num'>12</td>
      <td class='latex-source'>\sum_{i=1}^p \sum_{j=1}^q \sum_{k=1}^r a_{ij}b_{jk}c_{ki}</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p145</td>
    </tr>
    <tr data-latex="\sqrt{1+\sqrt{1+\sqrt{1+ \sqrt{1+\sqrt{1+\sqrt{1+ \sqrt{1+x}}}}}}}">
      <td class='test-num'>13</td>
      <td class='latex-source'>\sqrt{1+\sqrt{1+\sqrt{1+ \sqrt{1+\sqrt{1+\sqrt{1+ \sqrt{1+x}}}}}}}</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p145</td>
    </tr>
    <tr data-latex="\bigg(\frac{\partial^2} {\partial x^2} + \frac {\partial^2}{\partial y^2} \bigg){\big\lvert\varphi (x+iy)\big\rvert}^2">
      <td class='test-num'>14</td>
      <td class='latex-source'>\bigg(\frac{\partial^2} {\partial x^2} + \frac {\partial^2}{\partial y^2} \bigg){\big\lvert\varphi (x+iy)\big\rvert}^2</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p147</td>
    </tr>
    <tr data-latex="2^{2^{2^x}}">
      <td class='test-num'>15</td>
      <td class='latex-source'>2^{2^{2^x}}</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p128</td>
    </tr>
    <tr data-latex="\int_1^x {dt\over t}">
      <td class='test-num'>16</td>
      <td class='latex-source'>\int_1^x {dt\over t}</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p168</td>
    </tr>
    <tr data-latex="\int\!\!\!\int_D dx\,dy">
      <td class='test-num'>17</td>
      <td class='latex-source'>\int\!\!\!\int_D dx\,dy</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p169</td>
    </tr>
    <tr data-latex="f(x) = \begin{cases}1/3 &amp; \text{if }0 \le x \le 1; \\ 2/3 &amp; \text{if }3\le x \le 4;\\ 0 &amp; \text{elsewhere.} \end{cases}">
      <td class='test-num'>18</td>
      <td class='latex-source'>f(x) = \begin{cases}1/3 &amp; \text{if }0 \le x \le 1; \\ 2/3 &amp; \text{if }3\le x \le 4;\\ 0 &amp; \text{elsewhere.} \end{cases}</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p175</td>
    </tr>
    <tr data-latex="\overbrace{x +\cdots + x} ^{k \text{ times}}">
      <td class='test-num'>19</td>
      <td class='latex-source'>\overbrace{x +\cdots + x} ^{k \text{ times}}</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p176</td>
    </tr>
    <tr data-latex="y_{x^2}">
      <td class='test-num'>20</td>
      <td class='latex-source'>y_{x^2}</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p128</td>
    </tr>
    <tr data-latex="\sum_{p\text{ prime}}f(p) =\int_{t&gt;1} f(t)d\pi(t)">
      <td class='test-num'>21</td>
      <td class='latex-source'>\sum_{p\text{ prime}}f(p) =\int_{t&gt;1} f(t)d\pi(t)</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p181</td>
    </tr>
    <tr data-latex="\{\underbrace{\overbrace{ \mathstrut a,\dots,a}^{k \,a\rq\text{s}},\overbrace{ \mathstrut b,\dots,b}^{l\, b\rq\text{s}}}_{k+l \text{ elements}}\}">
      <td class='test-num'>22</td>
      <td class='latex-source'>\{\underbrace{\overbrace{ \mathstrut a,\dots,a}^{k \,a\rq\text{s}},\overbrace{ \mathstrut b,\dots,b}^{l\, b\rq\text{s}}}_{k+l \text{ elements}}\}</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p181</td>
    </tr>
    <tr data-latex="\begin{pmatrix} \begin{pmatrix}a&amp;b\\c&amp;d \end{pmatrix} &amp; \begin{pmatrix}e&amp;f\\g&amp;h \end{pmatrix} \\ 0 &amp; \begin{pmatrix}i&amp;j\\k&amp;l \end{pmatrix} \end{pmatrix}">
      <td class='test-num'>23</td>
      <td class='latex-source'>\begin{pmatrix} \begin{pmatrix}a&amp;b\\c&amp;d \end{pmatrix} &amp; \begin{pmatrix}e&amp;f\\g&amp;h \end{pmatrix} \\ 0 &amp; \begin{pmatrix}i&amp;j\\k&amp;l \end{pmatrix} \end{pmatrix}</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p181</td>
    </tr>
    <tr data-latex="\det\begin{vmatrix} c_0&amp;c_1&amp;c_2&amp;\dots&amp; c_n\\ c_1 &amp; c_2 &amp; c_3 &amp; \dots &amp; c_{n+1}\\ c_2 &amp; c_3 &amp; c_4 &amp;\dots &amp; c_{n+2}\\ \vdots &amp;\vdots&amp;\vdots &amp; &amp;\vdots \\c_n &amp; c_{n+1} &amp; c_{n+2} &amp;\dots&amp;c_{2n} \end{vmatrix} &gt; 0">
      <td class='test-num'>24</td>
      <td class='latex-source'>\det\begin{vmatrix} c_0&amp;c_1&amp;c_2&amp;\dots&amp; c_n\\ c_1 &amp; c_2 &amp; c_3 &amp; \dots &amp; c_{n+1}\\ c_2 &amp; c_3 &amp; c_4 &amp;\dots &amp; c_{n+2}\\ \vdots &amp;\vdots&amp;\vdots &amp; &amp;\vdots \\c_n &amp; c_{n+1} &amp; c_{n+2} &amp;\dots&amp;c_{2n} \end{vmatrix} &gt; 0</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p181</td>
    </tr>
    <tr data-latex="y_{x_2}">
      <td class='test-num'>25</td>
      <td class='latex-source'>y_{x_2}</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p128</td>
    </tr>
    <tr data-latex="x_{92}^{31415} + \pi">
      <td class='test-num'>26</td>
      <td class='latex-source'>x_{92}^{31415} + \pi</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p129</td>
    </tr>
    <tr data-latex="x_{y^a_b}^{z^c_d}">
      <td class='test-num'>27</td>
      <td class='latex-source'>x_{y^a_b}^{z^c_d}</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p129</td>
    </tr>
    <tr data-latex="y_3'''">
      <td class='test-num'>28</td>
      <td class='latex-source'>y_3'''</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'>TeXbook p130</td>
    </tr>
    <tr data-latex="\lim_{n\rightarrow+\infty} {\sqrt{2\pi n}\over n!} \genfrac (){}{}n{e}^n = 1">
      <td class='test-num'>29</td>
      <td class='latex-source'>\lim_{n\rightarrow+\infty} {\sqrt{2\pi n}\over n!} \genfrac (){}{}n{e}^n = 1</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'></td>
    </tr>
    <tr data-latex="\det(A) = \sum_{\sigma \in S_n} \epsilon(\sigma) \prod_{i=1}^n a_{i, \sigma_i}">
      <td class='test-num'>30</td>
      <td class='latex-source'>\det(A) = \sum_{\sigma \in S_n} \epsilon(\sigma) \prod_{i=1}^n a_{i, \sigma_i}</td>
      <td class='mathml-output loading'>Converting...</td>
      <td class='status loading'>⏳</td>
      <td class='comment'></td>
    </tr>
  </table>

  <!-- Import the compiled yatexml JavaScript library -->
  <script src="examples/latexToMathML.js"></script>

  <script>
    // Wait for the module to load
    window.addEventListener('load', function() {
      // Give the WASM/JS module time to initialize
      setTimeout(function() {
        const table = document.getElementById('test-table');
        const rows = table.querySelectorAll('tr[data-latex]');
        let successCount = 0;
        let totalCount = rows.length;

        rows.forEach(function(row) {
          const latex = row.getAttribute('data-latex')
            .replace(/&lt;/g, '<')
            .replace(/&gt;/g, '>')
            .replace(/&amp;/g, '&')
            .replace(/&quot;/g, '"');

          const outputCell = row.querySelector('.mathml-output');
          const statusCell = row.querySelector('.status');

          try {
            // Call the compiled Nim function
            const mathml = latexToMathML(latex);

            if (mathml && mathml !== 'ERROR') {
              outputCell.innerHTML = mathml;
              outputCell.className = 'mathml-output';
              statusCell.innerHTML = '✓';
              statusCell.className = 'success';
              successCount++;
            } else {
              outputCell.innerHTML = 'Conversion error';
              outputCell.className = 'error';
              statusCell.innerHTML = '✗';
              statusCell.className = 'error';
            }
          } catch (e) {
            outputCell.innerHTML = 'Error: ' + e.message;
            outputCell.className = 'error';
            statusCell.innerHTML = '✗';
            statusCell.className = 'error';
          }
        });

        // Update status
        const percentage = Math.round(successCount / totalCount * 100);
        document.getElementById('status').innerHTML =
          successCount + '/' + totalCount + ' tests passing (' + percentage + '%)';
        document.getElementById('status').className = '';
      }, 100);
    });
  </script>
</body>
</html>
